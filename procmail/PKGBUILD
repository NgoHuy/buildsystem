# Maintainer: Severus <severus@theslinux.org>
# Original Maintainer: Andreas Radke <andyrtr@archlinux.org>

pkgdesc="Highly configurable auto mail processing."
arch=('i686' 'x86_64')
url="http://www.procmail.org"
license=('GPL' 'custom:Artistic')
depends=('glibc' 'sh')
makedepends=('smtp-server')
source=(#"http://www.procmail.org/${pkgbase}-${pkgver}.tar.gz" # currently down
        "ftp://ftp.informatik.rwth-aachen.de/pub/packages/procmail/${pkgbase}-${pkgver}.tar.gz"
        'procmail-3.22-getline.patch')

build() {
  cd $srcdir/$pkgbase-$pkgver
  patch -p1 -i ${srcdir}/procmail-3.22-getline.patch
  yes n | make CFLAGS0="${CFLAGS} ${LDFLAGS}" LOCKINGTEST="/tmp ."
}

package() {
  cd $srcdir/$pkgbase-$pkgver
  make BASENAME=${pkgdir}/usr MANDIR=${pkgdir}/usr/share/man install
  install -D -m644 Artistic ${pkgdir}/usr/share/licenses/${pkgbase}/LICENSE
  install -d -m755 ${pkgdir}/usr/share/doc/${pkgbase}/examples
  install -m644 examples/* ${pkgdir}/usr/share/doc/${pkgbase}/examples/
}
