# Maintainer: Severus <severus@theslinux.org>
# Original Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Original Maintainer: Daniel J Griffiths <ghost1227@archlinux.us>
# Original Contributor: Roman Kyrylych <roman@archlinux.org>
# Original Contributor: cdhotfire <cdhotfire@gmail.com>

pkgdesc="An open source raw-image converter written in GTK+"
arch=('i686' 'x86_64')
license=('GPL')
url="http://rawstudio.org/"
depends=('exiv2' 'libgphoto2' 'flickcurl' 'libjpeg' 'fftw' 'gconf' 'lensfun'
	 'raptor1' 'lcms' 'gtk2')
install=${pkgbase}.install
options=('!libtool')
source=(http://rawstudio.org/files/release/${pkgbase}-${pkgver}.tar.gz
	libpng15.patch)

build() {
  cd "${srcdir}/${pkgbase}-${pkgver}"
  patch -p1 <$srcdir/libpng15.patch
  export LDFLAGS="$LDFLAGS `pkg-config --libs gthread-2.0`"
  ./configure --prefix=/usr
  make
}

package() {
  cd "${srcdir}/${pkgbase}-${pkgver}"
  make prefix="${pkgdir}/usr" install
  mkdir $pkgdir/usr/lib/rawstudio
  mv $pkgdir/usr/share/rawstudio/plugins $pkgdir/usr/lib/rawstudio
  ln -s ../../lib/rawstudio/plugins $pkgdir/usr/share/rawstudio/plugins
}
