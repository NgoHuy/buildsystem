#!/bin/bash

# Maintainer: Anh K. Huynh <kyanh@theslinux.org>
# Original Maintainer: Gaetan Bisson <bisson@archlinux.org>
# Original Contributor: damir <damir@archlinux.org>

pkgname=uim-vi
pkgver=1.8.5
pkgrel=1
pkgdesc='Vietnamese input method library'
url='http://code.google.com/p/uim/'
license=('custom:BSD')
arch=('i686' 'x86_64')
depends=('libxft' 'libedit' 'm17n-lib')
makedepends=('intltool' 'gettext' 'qt4' 'gtk2' 'gtk3')
optdepends=('qt4: immodule and helper applications'
            'gtk2: immodule and helper applications'
            'gtk3: immodules and helper applications')
options=('!libtool')
source=("uim-vi.patch"
        "http://uim.googlecode.com/files/uim-${pkgver}.tar.gz")
sha1sums=()

provides=('uim')
conflicts=('uim')
replaces=('uim')

install=install

build() {
	cd "${srcdir}/uim-${pkgver}"
	patch -Np4 < "${srcdir}/uim-vi.patch"
	./autogen.sh
	./configure \
		--prefix=/usr \
		--libexecdir=/usr/lib/uim \
		--without-anthy \
		--with-qt4-immodule \
		--with-qt4 \
		--disable-gnome-applet \
		--disable-dict \
		--without-skk \
		--without-mana \
		--without-prime \
		--without-sj3 \
		--without-scim \
		--without-eb \
		--without-osx-dcs \
		--without-sqlite3

	make
}

package() {
	cd "${srcdir}/uim-${pkgver}"
	make DESTDIR="${pkgdir}" install
	rm "${pkgdir}"/usr/lib/libgcroots.a
	install -D -m644 COPYING "${pkgdir}/usr/share/licenses/uim/COPYING"
	ln -s uim-pref-gtk "${pkgdir}/usr/bin/uim-setup"
}
